import"./index-i4XY-n0d.js";import{P as q}from"./placeholder-lK6OmsdP.js";import{s as f}from"./startCase-DZqAy5VZ.js";import{V}from"./vitel-YLUX6-hb.js";import{_ as B}from"./dynamic-D4K0hRtT.js";import{c as a,l as g,F as k,E as v,T as x,d as w,o as r,f as i,n as p,g as m,b,t as h,v as O}from"./vue.esm-bundler-TYCfHD9-.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as I}from"./entry-preview-DsY0GTd9.js";import"./_createCompounder-CVNnLs0D.js";import"./_baseSlice-kGIfUibS.js";import"./isObjectLike-Dipz0mOK.js";import"./isArray-Dxzbedgu.js";import"./isSymbol-C1qQj8zB.js";import"./isArrayLike-DYVE1Yub.js";const E={name:"$prompt",data(){return{stack:[],handler:null}},computed:{active(){return this.stack.at(-1)},isOpen(){return this.stack.length>0}},methods:{dialog(e){var l;let o=this,t={id:null,title:"Question",body:"",isHtml:!1,modalClass:"",modalDialogClass:"",component:null,componentProps:{},closable:!0,closeButton:!0,keyboard:!0,backdrop:!0,dialogClose:"reject",dialogClosePayload:"CANCEL",buttons:null,stack:!1,modelEl:null,modelBS:null,autoListen:"change",payloadResolve:void 0,payloadReject:void 0,promise:null,promiseResolve:()=>{},promiseReject:()=>{},...e};return t.closable||Object.assign(t,{closeButton:!1,keyboard:!1}),t.buttons&&(t.buttons=t.buttons.map(n=>typeof n=="object"?n:["accept","close","confirm","ok","save"].includes(n)?{click:"resolve",class:"btn btn-success",icon:"fas fa-check",title:f(n)}:["cancel"].includes(n)?{click:"reject",class:"btn btn-danger",icon:"fas fa-times",title:f(n)}:["back"].includes(n)?{click:"reject",class:"btn btn-light",icon:"fas fa-arrow-left",title:f(n)}:["-"].includes(n)?{class:"d-block flex-grow-1",title:""}:(()=>{throw new Error(`Unknown button shorthand "${n}"`)})())),t.autoListen&&t.component&&!((l=t.componentEvents)!=null&&l.change)&&(this.debug(`Enabling @${t.autoListen} event listener for $prompt component`),t.componentEvents={[t.autoListen](n){n&&n instanceof Event||(o.debug(`Set resolve payload from @${t.autoListen}`,{payload:n}),t.payloadResolve=n)},...t.componentEvents}),Promise.resolve().then(()=>{if(!t.stack)return this.debug(".dialog()","Closing all dialogs due to no-stacking option"),[...this.stack].reverse().reduce((n,c)=>(this.dialog("Close (no-stacking)",c.id),this.close(!1,"CLOSE-NOSTACKING")),Promise.resolve())}).then(()=>this.handler.push(t)).then(()=>t.promise=new Promise((n,c)=>{t.promiseResolve=n,t.promiseReject=c})).catch(n=>{if(n!==void 0)throw this.debug("Promise chain error",n),n})},close(e=!0,o){var t,l;return o===void 0&&((t=this.active)==null?void 0:t[e?"payloadResolve":"payloadReject"])!==void 0&&(o=(l=this.active)==null?void 0:l[e?"payloadResolve":"payloadReject"]),this.debug(".close()",{success:e,payload:o}),this.handler.pop(e,o)},closeIfOpen(e=!1,o){return this.isOpen?(this.debug(".closeIfOpen()",{success:e,payload:o}),this.handler.pop(e,o).then(()=>!0)):!1}},created(){}};E.__docgenInfo={exportName:"default",displayName:"prompt",type:1,props:[{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void"}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[{name:"stack",type:"any[]",description:"Current prompt stack if displaying multiple prompts",declarations:[],schema:{kind:"array",type:"any[]"}},{name:"handler",type:"any",description:"<prompt-handler/> VueComponent when it has registered itself",declarations:[],schema:"any"},{name:"active",type:"any",description:"The currently active prompt settings (if any)\nTaken as the last item in `stack`",declarations:[],schema:"any"},{name:"isOpen",type:"boolean",description:"Indicator that a modal is open",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}}],sourceFiles:"/home/runner/work/Vitel/Vitel/services/prompt.vue"};const R={components:{Dynamic:B},methods:{async push(e){return e.id||(e.id=`prompt-${Date.now()}`),this.$prompt.stack.push(e),await this.$nextTick(),e.modelEl=document.body.querySelector(`#prompt-handler #${e.id}`),e.modelEl.addEventListener("hidden.bs.modal",()=>this.$prompt.close(e.dialogClose=="resolve",e.dialogClosePayload)),e.modelBS=new window.bootstrap.Modal(e.modelEl,{backdrop:e.backdrop,keyboard:e.keyboard,focus:!0}),new Promise(o=>{e.modelEl.addEventListener("shown.bs.modal",()=>o()),e.modelBS.show()})},pop(e=!0,o){let t=this.$prompt.stack.pop();return t?(t.modelBS._isTransitioning?t.modelEl.addEventListener("shown.bs.modal",()=>t.modelBS.hide(),{once:!0}):t.modelBS.hide(),e?Promise.resolve(t.promiseResolve(o)):Promise.resolve(t.promiseReject(o))):Promise.resolve()},triggerButton(e){if(e!=null&&e.click){if(e.click=="resolve")return this.$prompt.close(!0);if(e.click=="reject")return this.$prompt.close(!1);if(typeof e.click=="function"){let o=this.$refs.dynamicOuter[0].$refs.dynamicInner;return Promise.resolve(e.click.call(o,o,e))}else throw new Error("No click handler set up on button")}else throw new Error("Invalid button spec")}},created(){if(!this.$prompt)throw new Error("$prompt service not found - check the service has been installed correctly");let e=document.createElement("div");e.id="prompt-handler",document.body.appendChild(e),this.$prompt.handler=this}},j=["id","aria-labelledby"],L=["id"],S=["onClick"],H={class:"modal-body"},T=["innerHTML"],K=["textContent"],D={key:1,class:"modal-footer d-flex d-justify-end"},F=["onClick"];function A(e,o,t,l,n,c){const y=w("dynamic");return r(),a("div",null,[(r(),g(x,{to:"#prompt-handler"},[(r(!0),a(k,null,v(e.$prompt.stack,s=>(r(),a("div",{key:s.id,class:"modal fade",id:s.id,tabindex:"-1","aria-labelledby":`${s.id}-header`,"aria-hidden":"true"},[i("div",{class:p(["modal-dialog",s.modalDialogClass])},[i("div",{class:p(["modal-content",s.modalClass])},[s.title?(r(),a("div",{key:0,id:`${s.id}-header`,class:"modal-header"},[b(h(s.title)+" ",1),s.closeButton?(r(),a("a",{key:0,onClick:d=>e.$prompt.close(s.dialogClose=="resolve",s.dialogClosePayload),class:"btn btn-link btn-close","aria-label":"Close"},[...o[0]||(o[0]=[i("i",{class:"fas fa-lg fa-times"},null,-1)])],8,S)):m("",!0)],8,L)):m("",!0),i("div",H,[s.isHtml?(r(),a("div",{key:0,innerHTML:s.body},null,8,T)):(r(),a("div",{key:1,textContent:h(s.body)},null,8,K)),s.component?(r(),g(y,{key:2,ref_for:!0,ref:"dynamicOuter","ref-handle":"dynamicInner",component:s.component,props:s.componentProps,events:s.componentEvents},null,8,["component","props","events"])):m("",!0)]),s.buttons&&s.buttons.length>0?(r(),a("div",D,[(r(!0),a(k,null,v(s.buttons,d=>(r(),a("a",{key:d,onClick:J=>c.triggerButton(d),class:p(d.class||"btn btn-light")},[d.icon?(r(),a("i",{key:0,class:p(d.icon)},null,2)):m("",!0),b(" "+h(d.title),1)],10,F))),128))])):m("",!0)],2)],2)],8,j))),128))]))])}const W=P(R,[["render",A]]);R.__docgenInfo={exportName:"default",displayName:"prompt-handler",type:1,props:[{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void"}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[],sourceFiles:"/home/runner/work/Vitel/Vitel/services/prompt-handler.vue"};const N={components:{PromptHandler:W}},M={class:"card mb-2"},U={class:"card-body"},z={class:"list-group"};function G(e,o,t,l,n,c){const y=w("prompt-handler");return r(),a("div",null,[O(y),i("div",M,[o[4]||(o[4]=i("div",{class:"card-header"},"Prompts",-1)),i("div",U,[o[3]||(o[3]=i("p",null,"Popup and other UI locking window functionality for simple input prompts",-1)),i("div",z,[i("a",{onClick:o[0]||(o[0]=s=>e.$prompt.dialog({body:"Hello World"})),class:"list-group-item list-group-item-action"}," $prompt.dialog({body: 'Hello World'}) "),i("a",{onClick:o[1]||(o[1]=s=>e.$prompt.dialog({body:"<strong>Hello</strong> World",isHtml:!0,buttons:["cancel","ok"]})),class:"list-group-item list-group-item-action"}," $prompt.dialog({body: '<strong>Hello</strong> World', isHtml: true, buttons: ['cancel', 'ok']}) "),i("a",{onClick:o[2]||(o[2]=s=>e.$prompt.dialog({component:"placeholder",componentProps:{text:"A model!"}})),class:"list-group-item list-group-item-action"}," $prompt.dialog({component: 'placeholder', componentProps: {text: 'A model!'}}) ")])])])])}const Q=P(N,[["render",G]]);N.__docgenInfo={exportName:"default",displayName:"prompt.demo",type:1,props:[{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void"}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[],sourceFiles:"/home/runner/work/Vitel/Vitel/services/prompt.demo.vue"};I(e=>{e.use(V),e.component("Placeholder",q),e.service("$prompt",E)});const me={title:"Services/Prompt",component:Q,tags:["autodocs"],argTypes:{}},u={};var $,_,C;u.parameters={...u.parameters,docs:{...($=u.parameters)==null?void 0:$.docs,source:{originalSource:"{}",...(C=(_=u.parameters)==null?void 0:_.docs)==null?void 0:C.source}}};const pe=["Example"];export{u as Example,pe as __namedExportsOrder,me as default};
